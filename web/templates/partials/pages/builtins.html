<section class="mb-10">
  <h1 class="text-3xl md:text-4xl font-bold tracking-tight">
    Built-in Functions
  </h1>
</section>

<!-- Overview -->
<section class="mb-10">
  <p class="mt-2 text-lg text-gray-300">
    Ego ships with a small, focused set of built-in functions.
    These are always available without any imports and cover
    common tasks like working with collections, doing type
    conversions, basic I/O, and constructing errors.
  </p>
</section>

<!-- Collections and Maps -->
<section class="mb-10">
  <h2 class="text-2xl font-bold">Collections and Maps</h2>
  <p class="mt-2 text-lg text-gray-300">
    These helpers work with arrays and maps: creating new arrays,
    clearing existing collections, copying values, and removing keys.
  </p>

  <div class="mt-4 grid md:grid-cols-2 gap-4 text-base text-gray-300">
    <!-- append -->
    <div class="rounded-2xl border border-gray-800 bg-gray-950 p-5">
      <h3 class="text-lg font-semibold">
        <code class="text-gray-200">append(array, value) -&gt; array</code>
      </h3>
      <p class="mt-2">
        Returns a <em>new</em> array with <code class="text-gray-200">value</code>
        appended to the end. The original array is left unchanged.
      </p>
      <pre class="mt-3 text-sm overflow-x-auto"><code class="text-gray-200">nums := [1, 2]
more := append(nums, 3)

put(len(nums))   # 2
put(len(more))   # 3</code></pre>
    </div>

    <!-- len -->
    <div class="rounded-2xl border border-gray-800 bg-gray-950 p-5">
      <h3 class="text-lg font-semibold">
        <code class="text-gray-200">len(array | map | string) -&gt; int</code>
      </h3>
      <p class="mt-2">
        Returns the number of elements in an array or map, or the
        number of characters in a string.
      </p>
      <pre class="mt-3 text-sm overflow-x-auto"><code class="text-gray-200">name := 'ego'
put(len(name))   # 3

arr := [10, 20, 30]
put(len(arr))    # 3

m := {'x': 1}
put(len(m))      # 1</code></pre>
    </div>

    <!-- clear -->
    <div class="rounded-2xl border border-gray-800 bg-gray-950 p-5">
      <h3 class="text-lg font-semibold">
        <code class="text-gray-200">clear(array | map) -&gt; nil</code>
      </h3>
      <p class="mt-2">
        Empties an existing array or map in-place and returns
        <code class="text-gray-200">nil</code>.
      </p>
      <pre class="mt-3 text-sm overflow-x-auto"><code class="text-gray-200">items := [1, 2, 3]
clear(items)
put(len(items))  # 0

m := {'a': 1, 'b': 2}
clear(m)
put(len(m))      # 0</code></pre>
    </div>

    <!-- copy -->
    <div class="rounded-2xl border border-gray-800 bg-gray-950 p-5">
      <h3 class="text-lg font-semibold">
        <code class="text-gray-200">copy(dst, src) -&gt; int</code>
      </h3>
      <p class="mt-2">
        Copies elements from <code class="text-gray-200">src</code> into
        <code class="text-gray-200">dst</code> (arrays or maps) and returns
        the number of elements copied.
      </p>
      <pre class="mt-3 text-sm overflow-x-auto"><code class="text-gray-200">src := [1, 2, 3]
dst := []

n := copy(dst, src)
put(n)        # 3
put(dst[0])   # 1</code></pre>
    </div>

    <!-- delete -->
    <div class="rounded-2xl border border-gray-800 bg-gray-950 p-5 md:col-span-2">
      <h3 class="text-lg font-semibold">
        <code class="text-gray-200">delete(map, key) -&gt; bool</code>
      </h3>
      <p class="mt-2">
        Removes <code class="text-gray-200">key</code> from a map. Returns
        <code class="text-gray-200">true</code> if the key was present and
        deleted, or <code class="text-gray-200">false</code> if the key
        was not found.
      </p>
      <pre class="mt-3 text-sm overflow-x-auto"><code class="text-gray-200">m := {'a': 1, 'b': 2}

ok := delete(m, 'a')
put(ok)        # true
put(m['a'])    # nil</code></pre>
    </div>
  </div>
</section>

<!-- Conversion and Introspection -->
<section class="mb-10">
  <h2 class="text-2xl font-bold">Conversion and Introspection</h2>
  <p class="mt-2 text-lg text-gray-300">
    These functions convert between basic types and let you inspect
    the type of a value.
  </p>

  <div class="mt-4 grid md:grid-cols-2 gap-4 text-base text-gray-300">
    <!-- int -->
    <div class="rounded-2xl border border-gray-800 bg-gray-950 p-5">
      <h3 class="text-lg font-semibold">
        <code class="text-gray-200">int(int | float | string) -&gt; int</code>
      </h3>
      <p class="mt-2">
        Converts the value to an integer. Strings must contain a
        valid integer representation or this results in an error.
      </p>
      <pre class="mt-3 text-sm overflow-x-auto"><code class="text-gray-200">n1 := int(3.9)
n2 := int('42')

put(n1)       # 3
put(n2 + 1)   # 43</code></pre>
    </div>

    <!-- float -->
    <div class="rounded-2xl border border-gray-800 bg-gray-950 p-5">
      <h3 class="text-lg font-semibold">
        <code class="text-gray-200">float(int | float | string) -&gt; float</code>
      </h3>
      <p class="mt-2">
        Converts the value to a floating-point number. Strings must
        contain a valid float representation.
      </p>
      <pre class="mt-3 text-sm overflow-x-auto"><code class="text-gray-200">f1 := float(3)
f2 := float('3.5')

put(f1 + f2)  # 6.5</code></pre>
    </div>

    <!-- str -->
    <div class="rounded-2xl border border-gray-800 bg-gray-950 p-5">
      <h3 class="text-lg font-semibold">
        <code class="text-gray-200">str(value) -&gt; string</code>
      </h3>
      <p class="mt-2">
        Returns a string representation of any value. Useful for
        building messages or debugging.
      </p>
      <pre class="mt-3 text-sm overflow-x-auto"><code class="text-gray-200">msg := 'answer = ' + str(42)
put(msg)</code></pre>
    </div>

    <!-- type -->
    <div class="rounded-2xl border border-gray-800 bg-gray-950 p-5">
      <h3 class="text-lg font-semibold">
        <code class="text-gray-200">type(value) -&gt; string</code>
      </h3>
      <p class="mt-2">
        Returns the name of the runtime type of a value, such as
        <code class="text-gray-200">'int'</code> or
        <code class="text-gray-200">'array'</code>.
      </p>
      <pre class="mt-3 text-sm overflow-x-auto"><code class="text-gray-200">put(type(10))        # 'int'
put(type(3.14))      # 'float'
put(type([1, 2, 3])) # 'array'</code></pre>
    </div>
  </div>
</section>

<!-- I/O and Interaction -->
<section class="mb-10">
  <h2 class="text-2xl font-bold">I/O and Interaction</h2>
  <p class="mt-2 text-lg text-gray-300">
    These functions print values and read input from the user.
  </p>

  <div class="mt-4 grid md:grid-cols-2 gap-4 text-base text-gray-300">
    <!-- put -->
    <div class="rounded-2xl border border-gray-800 bg-gray-950 p-5">
      <h3 class="text-lg font-semibold">
        <code class="text-gray-200">put(values...) -&gt; nil</code>
      </h3>
      <p class="mt-2">
        Prints each argument on its own line. A newline is written
        after every value.
      </p>
      <pre class="mt-3 text-sm overflow-x-auto"><code class="text-gray-200">put('one')
put('two', 'three')  # two lines</code></pre>
    </div>

    <!-- puts -->
    <div class="rounded-2xl border border-gray-800 bg-gray-950 p-5">
      <h3 class="text-lg font-semibold">
        <code class="text-gray-200">puts(values...) -&gt; nil</code>
      </h3>
      <p class="mt-2">
        Prints all arguments on a single line (typically separated by
        spaces) followed by a trailing newline.
      </p>
      <pre class="mt-3 text-sm overflow-x-auto"><code class="text-gray-200">puts('hello,', 'world')
# prints: hello, world</code></pre>
    </div>

    <!-- input -->
    <div class="rounded-2xl border border-gray-800 bg-gray-950 p-5 md:col-span-2">
      <h3 class="text-lg font-semibold">
        <code class="text-gray-200">input() | input(prompt string) -&gt; string</code>
      </h3>
      <p class="mt-2">
        Reads a single line of text from standard input. If a prompt
        string is provided, it is printed before reading.
      </p>
      <pre class="mt-3 text-sm overflow-x-auto"><code class="text-gray-200">name := input('Enter your name: ')
puts('Hello,', name)</code></pre>
    </div>
  </div>
</section>

<!-- Errors -->
<section class="mb-10">
  <h2 class="text-2xl font-bold">Errors</h2>
  <p class="mt-2 text-lg text-gray-300">
    Error values are used to signal failure from functions. Ego
    treats errors as regular values that you can construct and return.
  </p>

  <div class="mt-4 rounded-2xl border border-gray-800 bg-gray-950 overflow-hidden">
    <div class="px-5 py-3 border-b border-gray-800 flex items-center justify-between">
      <div class="text-sm text-gray-300 font-medium">errors_builtin.ego</div>
      <div class="text-xs text-gray-500">example</div>
    </div>
    <pre class="p-5 text-base overflow-x-auto"><code class="text-gray-200">:parse_int s
  # return an error value on failure
  if s == ''
    ret error('empty string')
  ;

  ret int(s)
;

result := parse_int('42')
put(result)</code></pre>
  </div>

  <div class="mt-4 space-y-3 text-base text-gray-300">
    <div>
      <span class="font-semibold">error(message string) -&gt; error.</span>
      Constructs a new error value carrying the given message. You
      typically return this from a function to signal failure.
    </div>
  </div>
</section>

<!-- Navigation: Previous -->
<section class="mt-12 pt-8 border-t border-gray-800 flex flex-col items-center text-center text-base gap-3">
  <div class="flex flex-col sm:flex-row gap-3">
    <button
      type="button"
      onclick="document.getElementById('link-errors')?.click()"
      class="inline-flex items-center justify-center gap-2 rounded-lg px-4 py-2 bg-gray-900 text-gray-200 border border-gray-700 hover:bg-gray-800 cursor-pointer w-full sm:w-auto"
    >
      <span aria-hidden="true">&larr;</span>
      <span class="font-medium">Errors and Diagnostics</span>
    </button>
  </div>
</section>
