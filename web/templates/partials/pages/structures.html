<section class="mb-10">
  <h1 class="text-3xl md:text-4xl font-bold tracking-tight">
    Data Structures
  </h1>
</section>

<!-- 9.1 Arrays -->
<section class="mb-10">
  <h2 class="text-2xl font-bold">Arrays</h2>
  <p class="mt-2 text-lg text-gray-300">
    Arrays store an ordered sequence of values. They are the simplest
    way to group related values together in Ego.
  </p>

  <div class="mt-4 rounded-2xl border border-gray-800 bg-gray-950 overflow-hidden">
    <div class="px-5 py-3 border-b border-gray-800 flex items-center justify-between">
      <div class="text-sm text-gray-300 font-medium">arrays.ego</div>
      <div class="text-xs text-gray-500">example</div>
    </div>
    <pre class="p-5 text-base overflow-x-auto"><code class="text-gray-200"><span class="comment"># empty array</span>
<span class="variable">arr</span> <span class="operator">:=</span> <span class="operator">[]</span>

<span class="comment"># new array with values</span>
<span class="variable">arr</span> <span class="operator">=</span> <span class="operator">[</span><span class="number">1</span>, <span class="string">'two'</span>, <span class="keyword">true</span><span class="operator">]</span>

<span class="function">put</span>(<span class="variable">arr</span><span class="operator">[</span><span class="number">1</span><span class="operator">]</span>)</code></pre>
  </div>

  <div class="mt-4 space-y-3 text-base text-gray-300">
    <div>
      <span class="font-semibold">Literal syntax.</span>
      Use square brackets <code class="text-gray-200">[]</code> to
      create an array literal. An empty pair of brackets creates an
      empty array, and values separated by commas create a populated
      array.
    </div>

    <div>
      <span class="font-semibold">Mixed values.</span>
      Arrays can hold values of different types in the same collection,
      such as numbers, strings, and booleans together.
    </div>

    <div>
      <span class="font-semibold">Indexing.</span>
      Use <code class="text-gray-200">arr[i]</code> syntax to read a
      value at a particular index. Indexes must be within the valid
      range for that array.
    </div>

    <div>
      <span class="font-semibold">Out-of-bounds behavior.</span>
      Accessing an index that does not exist for a given array is a
      runtime error; Ego does not grow arrays automatically or return a
      default value.
    </div>
  </div>
</section>

<!-- 9.2 Index Expressions -->
<section class="mb-10">
  <h2 class="text-2xl font-bold">Index Expressions</h2>
  <p class="mt-2 text-lg text-gray-300">
    Index expressions use square brackets to access or update elements
    inside arrays and maps.
  </p>

  <div class="mt-4 rounded-2xl border border-gray-800 bg-gray-950 overflow-hidden">
    <div class="px-5 py-3 border-b border-gray-800 flex items-center justify-between">
      <div class="text-sm text-gray-300 font-medium">index_expr.ego</div>
      <div class="text-xs text-gray-500">example</div>
    </div>
    <pre class="p-5 text-base overflow-x-auto"><code class="text-gray-200"><span class="variable">arr</span> <span class="operator">:=</span> <span class="operator">[</span><span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span><span class="operator">]</span>

<span class="variable">value</span> <span class="operator">:=</span> <span class="variable">arr</span><span class="operator">[</span><span class="number">1</span><span class="operator">]</span>
<span class="function">put</span>(<span class="variable">value</span>)

<span class="variable">arr</span><span class="operator">[</span><span class="number">1</span><span class="operator">]</span> <span class="operator">=</span> <span class="number">99</span>
<span class="function">put</span>(<span class="variable">arr</span><span class="operator">[</span><span class="number">1</span><span class="operator">]</span>)</code></pre>
  </div>

  <div class="mt-4 space-y-3 text-base text-gray-300">
    <div>
      <span class="font-semibold">Right-hand usage.</span>
      You can use an index expression like
      <code class="text-gray-200">arr[i]</code> wherever a normal value
      is allowed, for example on the right-hand side of
      <code class="text-gray-200">=</code> or
      <code class="text-gray-200">:=</code>.
    </div>

    <div>
      <span class="font-semibold">Left-hand usage.</span>
      Index expressions are valid assignment targets. Using
      <code class="text-gray-200">arr[i] = value</code> updates the
      element stored at that position.
    </div>

    <div>
      <span class="font-semibold">Works for arrays and maps.</span>
      The same square bracket syntax is used for both arrays and maps;
      the only difference is what type of value you use as the index or
      key.
    </div>
  </div>
</section>

<!-- Maps -->
<section class="mb-10">
  <h2 class="text-2xl font-bold">Maps</h2>
  <p class="mt-2 text-lg text-gray-300">
    Maps are key&ndash;value collections. Keys can be strings,
    integers, or booleans, and values can be any Ego type.
  </p>

  <div class="mt-4 rounded-2xl border border-gray-800 bg-gray-950 overflow-hidden">
    <div class="px-5 py-3 border-b border-gray-800 flex items-center justify-between">
      <div class="text-sm text-gray-300 font-medium">maps.ego</div>
      <div class="text-xs text-gray-500">example</div>
    </div>
    <pre class="p-5 text-base overflow-x-auto"><code class="text-gray-200"><span class="variable">m</span> <span class="operator">:=</span> <span class="operator">{</span>
  <span class="string">'key1'</span><span class="operator">:</span> <span class="string">'1'</span>,
  <span class="number">2</span><span class="operator">:</span> <span class="number">2</span>,
  <span class="keyword">true</span><span class="operator">:</span> <span class="string">'3'</span>
<span class="operator">}</span>

<span class="function">put</span>(<span class="variable">m</span><span class="operator">[</span><span class="string">'key1'</span><span class="operator">]</span>)

<span class="variable">two</span> <span class="operator">:=</span> <span class="number">2</span>
<span class="function">put</span>(<span class="variable">m</span><span class="operator">[</span><span class="variable">two</span><span class="operator">]</span>)

<span class="variable">m</span><span class="operator">[</span><span class="string">'key4'</span><span class="operator">]</span> <span class="operator">=</span> <span class="string">'four'</span>
<span class="function">put</span>(<span class="variable">m</span><span class="operator">[</span><span class="string">'key4'</span><span class="operator">]</span>)

<span class="variable">n</span> <span class="operator">:=</span> <span class="variable">m</span><span class="operator">[</span><span class="string">'nokey'</span><span class="operator">]</span>
<span class="function">put</span>(<span class="variable">n</span>)</code></pre>
  </div>

  <div class="mt-4 space-y-3 text-base text-gray-300">
    <div>
      <span class="font-semibold">Literal syntax.</span>
      Use curly braces with <code class="text-gray-200">key: value</code>
      pairs to create a map. Pairs are separated by commas.
    </div>

    <div>
      <span class="font-semibold">Key types.</span>
      Keys can be strings, integers, or booleans. Values can be any Ego
      value, including arrays, other maps, and functions.
    </div>

    <div>
      <span class="font-semibold">Trailing commas.</span>
      Trailing commas after the
      last key&ndash;value pair are allowed.
    </div>

    <div>
      <span class="font-semibold">Access via index expressions.</span>
      Use <code class="text-gray-200">m[key]</code> to read a value
      from a map. The key expression can be a literal or any expression
      that evaluates to a valid key type.
    </div>

    <div>
      <span class="font-semibold">Adding and updating keys.</span>
      Assigning with <code class="text-gray-200">m[key] = value</code>
      either updates an existing entry or creates a new key in the map.
    </div>

    <div>
      <span class="font-semibold">Missing keys.</span>
      If you access a key that is not present in the map, Ego returns
      <code class="text-gray-200">nil</code>.
    </div>
  </div>
</section>

<!-- Shared References -->
<section class="mb-10">
  <h2 class="text-2xl font-bold">Shared References</h2>
  <p class="mt-2 text-lg text-gray-300">
    Arrays and maps are always passed by reference in Ego. This means
    that when you pass them into a function or assign them to another
    variable, all names point at the same underlying collection. Any
    in-place change through one reference is visible through the others.
  </p>

  <div class="mt-4 rounded-2xl border border-gray-800 bg-gray-950 overflow-hidden">
    <div class="px-5 py-3 border-b border-gray-800 flex items-center justify-between">
      <div class="text-sm text-gray-300 font-medium">by_reference.ego</div>
      <div class="text-xs text-gray-500">example</div>
    </div>
    <pre class="p-5 text-base overflow-x-auto"><code class="text-gray-200"><span class="operator">:</span><span class="function">bump_first</span> <span class="variable">arr</span>
  <span class="comment"># modifies the same array the caller sees</span>
  <span class="variable">arr</span><span class="operator">[</span><span class="number">0</span><span class="operator">]</span> <span class="operator">=</span> <span class="variable">arr</span><span class="operator">[</span><span class="number">0</span><span class="operator">]</span> <span class="operator">+</span> <span class="number">1</span>
<span class="operator">;</span>

<span class="variable">nums</span> <span class="operator">:=</span> <span class="operator">[</span><span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span><span class="operator">]</span>
<span class="variable">other</span> <span class="operator">:=</span> <span class="variable">nums</span>        <span class="comment"># points at the same array</span>

<span class="function">bump_first</span>(<span class="variable">nums</span>)
<span class="function">put</span>(<span class="variable">nums</span><span class="operator">[</span><span class="number">0</span><span class="operator">]</span>)         <span class="comment"># 2</span>
<span class="function">put</span>(<span class="variable">other</span><span class="operator">[</span><span class="number">0</span><span class="operator">]</span>)        <span class="comment"># 2 (also changed)</span>

<span class="operator">:</span><span class="function">set_flag</span> <span class="variable">m</span>
  <span class="variable">m</span><span class="operator">[</span><span class="string">'done'</span><span class="operator">]</span> <span class="operator">=</span> <span class="keyword">true</span>   <span class="comment"># updates the original map</span>
<span class="operator">;</span>

<span class="variable">state</span> <span class="operator">:=</span> <span class="operator">{}</span>
<span class="function">set_flag</span>(<span class="variable">state</span>)
<span class="function">put</span>(<span class="variable">state</span><span class="operator">[</span><span class="string">'done'</span><span class="operator">]</span>)   <span class="comment"># true</span></code></pre>
  </div>

  <div class="mt-4 space-y-3 text-base text-gray-300">
    <div>
      <span class="font-semibold">No copies on pass.</span>
      Passing an array or map into a function does not create a copy;
      the callee sees and can mutate the caller's collection.
    </div>

    <div>
      <span class="font-semibold">Assignment shares storage.</span>
      Simple assignments like <code class="text-gray-200">b = a</code>
      for arrays or maps share the same underlying data until you
      explicitly build a new collection.
    </div>
  </div>
</section>

<!-- Navigation: Previous / Next -->
<section class="mt-12 pt-8 border-t border-gray-800 flex flex-col items-center text-center text-base gap-3">
  <div class="flex flex-col sm:flex-row gap-3">
    <button
      type="button"
      onclick="document.getElementById('link-functions')?.click()"
      class="inline-flex items-center justify-center gap-2 rounded-lg px-4 py-2 bg-gray-900 text-gray-200 border border-gray-700 hover:bg-gray-800 cursor-pointer w-full sm:w-auto"
    >
      <span aria-hidden="true">&larr;</span>
      <span class="font-medium">Functions</span>
    </button>

    <button
      type="button"
      onclick="document.getElementById('link-scope')?.click()"
      class="inline-flex items-center justify-center gap-2 rounded-lg px-4 py-2 bg-gray-800 text-gray-100 hover:bg-gray-700 cursor-pointer w-full sm:w-auto"
    >
      <span class="font-medium">Scope and Lifetime</span>
      <span aria-hidden="true">&rarr;</span>
    </button>
  </div>
</section>
